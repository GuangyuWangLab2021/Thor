Search.setIndex({"docnames": ["API", "FAQ", "Mjolnir", "Mjolnir_installation", "Mjolnir_test_data", "Mjolnir_video_tutorials", "_autosummary/thor.analy.SPARKX", "_autosummary/thor.analy.adata_to_mtx_conversion", "_autosummary/thor.analy.analyze_gene_expression_gradient", "_autosummary/thor.analy.compute_dge_between_regions", "_autosummary/thor.analy.get_pathway_score", "_autosummary/thor.analy.get_tf_activity", "_autosummary/thor.analy.prepare_and_run_copykat", "_autosummary/thor.analy.read_polygon_ROI", "_autosummary/thor.analy.run_commot", "_autosummary/thor.fineST", "_autosummary/thor.pl.annotate_ROI", "_autosummary/thor.pl.clusters", "_autosummary/thor.pl.deg", "_autosummary/thor.pl.fringe", "_autosummary/thor.pl.multi_molecules", "_autosummary/thor.pl.multiple", "_autosummary/thor.pl.single", "_autosummary/thor.pl.single_molecule", "_autosummary/thor.pl.spot_over", "_autosummary/thor.pp.Spatial", "_autosummary/thor.pp.WholeSlideImage", "_autosummary/thor.pp.load_cellpose", "_autosummary/thor.pp.load_cellprofiler", "_autosummary/thor.pp.load_mask_npz", "_autosummary/thor.pp.load_nuclei", "_autosummary/thor.pp.nuclei_segmentation", "_autosummary/thor.pp.preprocess_image", "about", "index", "installation", "notebooks/runThor_DCIS", "notebooks/runThor_MOB", "notebooks/run_thor_analyses_HF", "notebooks/tutorial_runThor_VisiumHD", "notebooks/tutorial_run_cell_communication_commot", "release_notes"], "filenames": ["API.rst", "FAQ.rst", "Mjolnir.rst", "Mjolnir_installation.rst", "Mjolnir_test_data.rst", "Mjolnir_video_tutorials.rst", "_autosummary/thor.analy.SPARKX.rst", "_autosummary/thor.analy.adata_to_mtx_conversion.rst", "_autosummary/thor.analy.analyze_gene_expression_gradient.rst", "_autosummary/thor.analy.compute_dge_between_regions.rst", "_autosummary/thor.analy.get_pathway_score.rst", "_autosummary/thor.analy.get_tf_activity.rst", "_autosummary/thor.analy.prepare_and_run_copykat.rst", "_autosummary/thor.analy.read_polygon_ROI.rst", "_autosummary/thor.analy.run_commot.rst", "_autosummary/thor.fineST.rst", "_autosummary/thor.pl.annotate_ROI.rst", "_autosummary/thor.pl.clusters.rst", "_autosummary/thor.pl.deg.rst", "_autosummary/thor.pl.fringe.rst", "_autosummary/thor.pl.multi_molecules.rst", "_autosummary/thor.pl.multiple.rst", "_autosummary/thor.pl.single.rst", "_autosummary/thor.pl.single_molecule.rst", "_autosummary/thor.pl.spot_over.rst", "_autosummary/thor.pp.Spatial.rst", "_autosummary/thor.pp.WholeSlideImage.rst", "_autosummary/thor.pp.load_cellpose.rst", "_autosummary/thor.pp.load_cellprofiler.rst", "_autosummary/thor.pp.load_mask_npz.rst", "_autosummary/thor.pp.load_nuclei.rst", "_autosummary/thor.pp.nuclei_segmentation.rst", "_autosummary/thor.pp.preprocess_image.rst", "about.rst", "index.rst", "installation.rst", "notebooks/runThor_DCIS.ipynb", "notebooks/runThor_MOB.ipynb", "notebooks/run_thor_analyses_HF.ipynb", "notebooks/tutorial_runThor_VisiumHD.ipynb", "notebooks/tutorial_run_cell_communication_commot.ipynb", "release_notes.rst"], "titles": ["Classes", "Frequently asked questions", "About Mjolnir", "Mjolnir Installation", "Mjolnir test Data", "Mjolnir video tutorials", "thor.analy.SPARKX", "thor.analy.adata_to_mtx_conversion", "thor.analy.analyze_gene_expression_gradient", "thor.analy.compute_dge_between_regions", "thor.analy.get_pathway_score", "thor.analy.get_tf_activity", "thor.analy.prepare_and_run_copykat", "thor.analy.read_polygon_ROI", "thor.analy.run_commot", "thor.fineST", "thor.pl.annotate_ROI", "thor.pl.clusters", "thor.pl.deg", "thor.pl.fringe", "thor.pl.multi_molecules", "thor.pl.multiple", "thor.pl.single", "thor.pl.single_molecule", "thor.pl.spot_over", "thor.pp.Spatial", "thor.pp.WholeSlideImage", "thor.pp.load_cellpose", "thor.pp.load_cellprofiler", "thor.pp.load_mask_npz", "thor.pp.load_nuclei", "thor.pp.nuclei_segmentation", "thor.pp.preprocess_image", "About Thor", "About Thor", "Thor Installation", "Ductal carcinoma in situ", "Mouse olfactory bulb", "Human heart failure", "Run Thor on Visium HD data", "Cell cell communication", "Release Notes"], "terms": {"import": [0, 1, 10, 15, 18, 21, 22, 26, 35, 40], "thor": [0, 1, 38, 41], "welcom": 1, "ani": [1, 15, 18, 20, 22, 23], "suggest": 1, "bug": 1, "report": 1, "pleas": [1, 25, 36, 37, 38, 39, 40], "send": 1, "them": [1, 26], "github": [1, 35, 41], "issu": 1, "how": [1, 38, 39, 40], "load": [1, 6, 15, 26, 27, 28, 29, 30, 37], "extern": [1, 15, 26, 38], "cell": [1, 2, 5, 7, 10, 11, 12, 14, 15, 17, 20, 21, 22, 23, 24, 26, 32], "featur": [1, 15, 26, 32, 33, 34, 36, 38, 39], "you": [1, 3, 15, 35, 36, 37, 38, 39, 40], "can": [1, 3, 15, 21, 22, 26, 31, 32, 33, 34, 35, 36, 37, 38, 39], "pass": [1, 15, 19, 31], "csv": [1, 10, 15, 26, 32, 36, 37, 38, 39], "file": [1, 3, 7, 8, 13, 15, 25, 26, 27, 28, 29, 30, 32, 35, 36, 37, 38, 39], "name": [1, 7, 10, 11, 12, 15, 18, 19, 20, 21, 22, 23, 25, 26, 36, 37, 38, 39], "external_cell_features_csv_path": [1, 26], "paramet": [1, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 38, 40], "pp": [1, 36, 37, 38, 39, 40], "wholeslideimag": [1, 36, 37, 39], "class": [1, 6, 15, 25, 26, 34], "method": [1, 6, 9, 14, 15, 25, 26, 31, 33, 34, 36, 37, 39, 40], "load_external_cell_featur": [1, 26], "from": [1, 2, 8, 10, 12, 13, 15, 18, 19, 26, 27, 28, 29, 30, 31, 32, 33, 34, 36, 37, 38, 39], "your": [1, 3, 35], "datafram": [1, 6, 8, 9, 10, 11, 18, 19, 32, 36, 37, 38, 39], "wsi": [1, 15, 26, 33, 34, 36, 37, 39], "image_path": [1, 15, 25, 26, 31, 32, 36, 37, 38, 39], "path": [1, 6, 8, 10, 13, 15, 25, 26, 27, 28, 29, 30, 31, 32, 36, 37, 38, 39], "cell_featur": [1, 36, 37, 39], "i": [2, 3, 6, 7, 8, 9, 10, 11, 12, 14, 15, 17, 18, 20, 21, 22, 23, 25, 26, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41], "an": [2, 3, 15, 33, 34, 35, 36, 38, 40], "interact": [2, 33, 34, 36, 38], "user": [2, 3, 15, 25, 36, 37, 40], "friendli": 2, "web": [2, 3, 33, 34, 38], "base": [2, 6, 15, 22, 25, 26, 33, 34, 36, 38, 39], "platform": [2, 38], "design": 2, "larg": 2, "imag": [2, 8, 13, 15, 16, 17, 20, 21, 22, 23, 25, 26, 31, 32, 38, 39, 40], "multi": [2, 33, 34, 40], "omic": [2, 33, 34, 40], "data": [2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 18, 19, 24, 25, 36, 38], "visual": [2, 3, 5, 12, 15, 37, 38], "analysi": [2, 3, 9, 10, 12, 14, 25, 35, 38, 40], "offer": [2, 33, 34], "seamless": 2, "tissu": [2, 33, 34, 38, 40], "scale": [2, 15, 24, 36, 37, 38, 39, 40], "empow": 2, "research": [2, 33, 34], "clinician": 2, "comprehens": 2, "understand": 2, "genom": [2, 12, 36, 37, 39], "histologi": [2, 33, 34, 37], "pattern": [2, 6, 33, 34], "we": [3, 15, 35, 36, 38], "make": 3, "publicli": 3, "avail": [3, 15], "webserv": 3, "soon": [3, 41], "after": [3, 15, 36, 37], "our": [3, 36, 37, 38], "paper": [3, 38, 40], "publish": 3, "current": [3, 7, 12, 15, 36, 37, 38, 39, 40], "app": 3, "The": [3, 4, 8, 10, 14, 15, 16, 21, 22, 26, 31, 32, 33, 34, 36, 37, 38, 39, 40], "follow": [3, 10, 11, 15, 25, 35, 36, 37, 38], "instruct": 3, "have": [3, 21, 22, 26, 35, 36, 37], "been": 3, "test": [3, 9, 34, 35], "maco": [3, 35], "linux": [3, 35], "window": [3, 12, 18, 19, 35], "plan": 3, "server": 3, "so": [3, 15, 36, 37, 39], "don": 3, "t": [3, 9, 15], "need": [3, 15, 26, 33, 34, 36, 37, 38], "anyth": 3, "abl": 3, "upload": [3, 35], "python": [3, 35], "3": [3, 15, 16, 36, 37, 38, 39, 40], "9": [3, 15, 35, 36, 37, 38, 39, 40], "later": [3, 35], "pip": [3, 35], "packag": [3, 12, 35], "manag": [3, 35], "n": [3, 12, 35, 36, 38], "unzip": [3, 35], "navig": [3, 35], "root": [3, 36, 37, 38, 39], "directori": [3, 6, 7, 12, 15, 25, 31, 35, 36, 39, 40], "repositori": 3, "e": [3, 12, 15, 31, 36, 37], "contain": [3, 7, 8, 9, 10, 11, 13, 15, 20, 21, 22, 23, 24, 25, 36, 37, 39], "setup": 3, "py": [3, 36], "cd": [3, 35], "On": 3, "r": [3, 6, 12, 36], "txt": 3, "w": [3, 37], "browser": [3, 38], "should": [3, 10, 11, 15, 21, 22, 25, 26, 32, 35, 36, 37], "automat": [3, 22], "open": [3, 35, 36, 41], "run": [3, 6, 12, 14, 15, 34, 35, 37, 38], "command": 3, "human": [4, 12, 34, 36], "heart": [4, 34], "myocardi": [4, 38, 40], "infarct": [4, 38, 40], "googl": [4, 36, 37, 38], "drive": [4, 36, 37, 38], "ductal_carcinoma_in_stu": 4, "gene": [5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 18, 19, 20, 21, 22, 23, 33, 34, 40], "express": [5, 6, 7, 8, 9, 12, 15, 18, 19, 20, 21, 22, 23, 24, 33, 34], "spot": [5, 15, 24, 26, 33, 34, 36, 38, 39], "level": [5, 15, 24, 25], "pathwai": [5, 10, 11, 33, 34, 35], "enrich": [5, 35], "heatmap": [5, 12, 38], "semi": [5, 33, 34], "supervis": [5, 33, 34], "annot": [5, 7, 9, 10, 11, 13, 14, 16, 18, 19, 24, 33, 34, 36], "rscript_path": 6, "run_sparkx": 6, "kwarg": [6, 14, 15, 26], "sourc": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 36, 38, 41], "object": [6, 7, 15, 17, 20, 21, 22, 23, 25, 26, 36, 37, 38, 39, 40], "spark": 6, "x": [6, 7, 10, 11, 12, 15, 18, 19, 26, 27, 28, 29, 30, 32, 36, 37, 38, 39, 40], "str": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 19, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 40], "default": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 18, 19, 20, 21, 22, 23, 24, 26, 32, 36, 37, 39], "script": [6, 12, 36, 37], "run_sparkx_r": 6, "adata_path": [6, 36], "none": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 30, 31, 32, 36, 37, 38, 39, 40], "layer": [6, 7, 8, 10, 11, 12, 15, 36, 38, 40], "out_path": 6, "provid": [6, 15, 21, 22, 25, 26, 32, 33, 34, 39], "anndata": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 24, 36, 37, 38, 39, 40], "us": [6, 7, 9, 10, 11, 12, 14, 15, 18, 21, 22, 25, 26, 31, 33, 34, 35], "output": [6, 7, 8, 12, 15, 25, 27, 28, 35, 36, 37, 39], "static": [6, 26, 36], "compute_pattern_mean": 6, "adata": [6, 7, 8, 10, 11, 12, 13, 14, 15, 26, 36, 38, 39], "obskey_prefix": 6, "comput": [6, 8, 9, 12, 15, 33, 34, 36, 37, 38, 39], "mean": [6, 8, 12, 15, 26, 32, 36, 37, 40], "each": [6, 10, 11, 17, 20, 21, 23, 32, 33, 34], "modul": [6, 33, 34, 37, 40], "panda": [6, 10, 18, 19, 36, 37, 39, 40], "n_sig_gen": 6, "n_cell": [6, 20, 23, 27, 28, 29, 30, 36, 39], "residu": 6, "matrix": [6, 7, 8, 9, 10, 11, 13, 14, 24, 31, 33, 34, 36, 37, 38, 39], "1": [6, 8, 9, 12, 15, 18, 21, 22, 24, 26, 36, 37, 38, 39, 40], "column": [6, 10, 11, 15, 18, 19, 26, 32, 36, 37, 38, 39, 40], "cluster": [6, 40], "index": [6, 26, 32, 36, 40], "prefix": [6, 15], "observ": [6, 15, 20, 22, 23, 24], "kei": [6, 8, 13, 14, 15, 24], "return": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 32], "type": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 33, 34, 36], "hierarchy_clust": 6, "hc_kwarg": 6, "hierarch": 6, "sklearn": 6, "": [6, 12, 21, 36, 37, 38, 39], "agglomerativeclust": 6, "dict": [6, 14, 15, 17, 18, 20, 21, 22, 23, 31], "keyword": [6, 14, 15, 17, 18, 20, 21, 22, 23, 24, 26, 31], "argument": [6, 14, 15, 17, 18, 20, 21, 22, 23, 24, 26, 31], "label": [6, 12, 17, 26, 27, 28, 29, 30, 32], "numpi": [6, 9, 13, 17, 20, 21, 22, 23, 27, 28, 29, 30, 36, 37, 38, 39, 40], "ndarrai": [6, 8, 9, 13], "kmeans_clust": 6, "n_pattern": 6, "kmeans_kwarg": 6, "k": [6, 12, 15, 37], "kmean": 6, "int": [6, 8, 12, 15, 16, 21, 22], "number": [6, 8, 12, 15, 26, 33, 34], "load_gene_modul": 6, "pattern_prefix": 6, "sp": 6, "load_result": [6, 15, 36, 37, 38, 39], "result": [6, 7, 9, 10, 12, 15, 26, 27, 28, 29, 30, 32, 37], "save_path": [7, 32], "convert": 7, "market": 7, "format": [7, 14, 15, 26, 30, 31, 32, 36, 37, 38, 39], "option": [7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 20, 21, 22, 23, 24, 26, 30, 32], "save": [7, 12, 15, 25, 26, 31, 32, 36, 39], "If": [7, 12, 15, 17, 20, 21, 22, 23, 26, 32, 35, 36], "work": [7, 12], "input": [7, 8, 12, 14, 15, 20, 23, 32, 36, 37, 38], "ar": [7, 8, 9, 10, 12, 13, 15, 19, 26, 32, 33, 34, 36, 37, 38], "mtx": 7, "tsv": 7, "barcod": 7, "img_kei": [8, 13, 36, 37], "fullr": [8, 13, 40], "layer_kei": 8, "range_from_edg": 8, "tupl": [8, 15, 17, 18, 20, 21, 22, 23, 24, 26, 31, 32], "150": [8, 21, 38], "baseline_from_edg": [8, 18], "100": [8, 15, 25, 36, 37, 38, 39, 40], "bin_siz": 8, "30": [8, 21, 22, 36, 37, 38, 40], "n_top_gen": 8, "10": [8, 12, 15, 21, 22, 25, 26, 35, 36, 37, 38, 39, 40], "min_mean_gene_express": 8, "float": [8, 9, 10, 11, 12, 15, 21, 22, 24, 36], "0": [8, 9, 12, 15, 18, 19, 22, 24, 26, 35, 36, 37, 38, 39, 40], "tmpout_path": 8, "geg": 8, "json": [8, 13, 15, 36, 38], "analyz": [8, 14, 33, 34], "against": [8, 18, 19], "baselin": [8, 16, 18, 19], "select": [8, 15, 21, 33, 34], "region": [8, 9, 14, 21, 22, 36], "interest": [8, 21, 22], "roi": [8, 13, 16, 21, 22, 33, 34], "where": [8, 12, 13, 15, 18, 21, 22, 25, 31, 33, 34], "drawn": [8, 13], "valid": [8, 9, 13, 15, 21, 32], "lowr": [8, 13, 36, 37], "unlik": 8, "hire": [8, 13, 36, 37], "rang": [8, 12, 15], "edg": [8, 36, 37, 38, 39], "size": [8, 12, 17, 18, 19, 20, 21, 22, 23, 24, 25, 31, 33, 34, 36], "bin": [8, 18, 19, 33, 34], "differenti": [8, 9, 33, 34], "top": [8, 24, 36], "plot": [8, 12, 15, 17, 18, 19, 20, 21, 22, 23, 24, 36], "minimum": [8, 9, 15, 22], "filter": [8, 12, 14, 36], "temporari": [8, 15], "A": [8, 9, 12, 15, 18, 21, 22], "polygon": [8, 13, 16, 36], "pd": [8, 10, 11, 18, 36, 37, 39, 40], "np": [8, 9, 13, 21, 22, 36, 37, 38, 39, 40], "ad_r1": 9, "ad_r2": 9, "test_method": 9, "pval_cutoff": 9, "01": [9, 36, 37, 38, 40], "log2fc_min": 9, "log2fc_max": 9, "dge": 9, "between": [9, 15, 33, 34, 36, 37, 38], "two": [9, 15, 18, 26, 36, 37, 38, 39], "2": [9, 13, 15, 18, 26, 27, 28, 29, 30, 36, 37, 38, 40], "statist": 9, "logreg": 9, "wilcoxon": 9, "test_overestim_var": 9, "p": 9, "valu": [9, 12, 15, 18, 19, 20, 21, 22, 23, 24, 32, 36, 40], "cutoff": 9, "signific": 9, "log2": [9, 36], "fold": 9, "chang": 9, "maximum": [9, 22], "arrai": [9, 13, 15, 16, 17, 20, 21, 22, 23, 27, 28, 29, 30, 36], "net_df": [10, 11, 36, 38], "smooth_radiu": [10, 11], "200": [10, 11, 36, 37, 38, 39], "calcul": [10, 11, 36, 38, 40], "score": [10, 11, 36, 38], "over": 10, "represent": [10, 15], "network": [10, 11, 15, 33, 34, 37], "inform": [10, 11, 12, 33, 34, 36, 37, 38, 39], "It": [10, 11, 18, 25], "geneset": [10, 36, 38], "genesymbol": [10, 36, 38], "weight": [10, 11, 15, 36, 37, 38, 39], "radiu": [10, 11, 15, 32, 36, 37, 38, 39], "smooth": [10, 11, 15, 38, 39], "var_nam": [10, 11, 15, 22], "note": [10, 12, 15, 18, 21, 22, 26, 34, 36, 37, 39], "thi": [10, 11, 14, 15, 18, 21, 22, 25, 33, 34, 36, 37, 38, 39, 40], "function": [10, 11, 12, 14, 15, 17, 18, 20, 21, 22, 23, 25, 26, 31, 32, 33, 34, 36], "dc": [10, 36, 38], "run_ora": 10, "perform": [10, 15, 25, 36, 37, 38], "store": [10, 15, 36, 37, 38, 39], "obsm": [10, 15, 36, 37, 38, 39, 40], "attribut": [10, 15, 36, 37], "exampl": [10, 18, 21, 22, 26, 40], "scanpi": [10, 24, 25, 36, 38, 39, 40], "sc": [10, 36, 37, 38, 39, 40], "ad": [10, 15, 24, 36, 37, 38, 39, 40], "dataset": [10, 36, 37, 39], "pbmc3k_process": 10, "read_csv": [10, 39], "count": [10, 15, 40], "infer": [11, 15, 36, 37, 39], "tf": [11, 38], "activ": [11, 33, 34, 35, 36, 39], "collectri": [11, 38], "databas": [11, 38], "univari": 11, "linear": 11, "model": [11, 15], "target": [11, 36, 38], "regul": [11, 15, 18, 38], "datadir": [12, 36], "batch_siz": 12, "id_typ": 12, "ngene_chr": 12, "5": [12, 15, 18, 19, 21, 22, 24, 36, 37, 38, 39, 40], "win_siz": 12, "25": [12, 36, 39, 40], "ks_cut": 12, "sam_nam": [12, 36], "distanc": [12, 14, 15, 18, 19, 32, 33, 34, 40], "euclidean": 12, "norm_cell_nam": 12, "output_seg": 12, "fals": [12, 15, 17, 18, 19, 20, 21, 22, 23, 26, 36, 37, 38, 39], "plot_gen": [12, 40], "true": [12, 15, 17, 18, 20, 21, 22, 23, 25, 26, 32, 36, 37, 38, 39, 40], "hg20": 12, "n_core": 12, "copykat": [12, 36], "bool": [12, 15, 18, 19, 20, 21, 22, 23, 26, 32], "requir": [12, 15, 36], "instal": [12, 34, 36, 37, 38, 39, 40], "refer": [12, 25, 36, 37, 38, 39, 40], "document": [12, 25], "more": [12, 14, 15, 36, 37, 38, 39], "subfold": 12, "process": [12, 14, 15, 25, 26, 32, 36, 37, 38, 39], "parallel": [12, 15], "id": [12, 15, 26], "identif": 12, "which": [12, 15, 22, 38], "symbol": [12, 14], "other": [12, 15, 22, 33, 34, 38], "ensembl": 12, "ngene": 12, "chr": 12, "minim": [12, 25], "per": [12, 21, 22], "chromosom": 12, "win": 12, "segment": [12, 15, 26, 27, 28, 29, 30, 31, 32, 33, 34, 36, 39], "cut": 12, "larger": 12, "looser": 12, "criteria": 12, "sam": 12, "sampl": [12, 15, 36, 38, 39, 40], "metric": 12, "pearson": 12, "spearman": 12, "norm": 12, "vector": [12, 23], "normal": [12, 15, 20, 23, 36], "seg": 12, "whether": [12, 15, 18, 19, 21, 22, 26, 32], "igv": 12, "string": [12, 36], "boolean": 12, "cna": 12, "genenam": 12, "version": [12, 35, 37], "20": [12, 15, 21, 22, 25, 36, 37, 38, 39, 40], "mm10": [12, 37], "mous": [12, 34], "core": [12, 36, 37, 39], "cpu": 12, "recommend": [12, 15, 25], "onli": [12, 25, 26, 33, 34, 37], "split": [12, 26, 38], "smaller": 12, "chunk": 12, "prepar": [12, 14, 15], "json_path": [13, 15], "read": [13, 15, 25], "un": [13, 36, 37, 38, 39, 40], "spatial": [13, 15, 21, 22, 24, 36, 38, 40], "wa": [13, 35, 36, 37, 38, 39, 40], "full": [13, 21, 22, 24, 25, 31, 32, 33, 34, 36], "resolut": [13, 24, 31, 32, 36, 37, 39], "roi_shap": 13, "shape": [13, 16, 20, 23, 36, 39], "n_vertic": 13, "coordin": [13, 15, 26, 32, 36, 37, 38, 39], "gene_symbols_kei": 14, "feature_nam": [14, 40], "commun": [14, 34], "modifi": 14, "commot": 14, "wrapper": [14, 26], "tl": [14, 39, 40], "spatial_commun": 14, "first": [14, 15, 26, 33, 34, 36, 37, 38, 39], "precomput": 14, "effici": [14, 40], "support": [14, 15, 21, 26], "spars": [14, 15, 31], "list": [14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 32, 36, 40], "left": [14, 21, 22, 26, 36], "right": [14, 15, 26, 36], "lower": [14, 15, 26, 36, 38], "upper": [14, 21, 26], "var": [14, 15, 23, 36, 37, 38, 39, 40], "addit": [14, 15, 17, 20, 21, 22, 23, 32, 33, 34, 35], "spot_adata_path": [15, 26, 36, 37, 38, 39], "st_dir": [15, 25, 37], "cell_features_list": [15, 37], "cell_features_csv_path": [15, 26, 36, 37, 38, 39], "genes_path": 15, "save_dir": [15, 25, 26, 31], "recip": [15, 36, 37, 38, 39], "silico": [15, 33, 34], "whole": [15, 26, 32, 36, 39], "slide": [15, 26, 33, 34, 36, 39], "align": [15, 33, 34, 36, 37, 38, 39], "transcriptom": [15, 25, 38, 40], "g": [15, 36], "visium": [15, 36, 37], "sequenc": [15, 25], "h5ad": [15, 36, 37, 38, 39, 40], "expect": [15, 26], "lognorm": 15, "One": 15, "neglect": 15, "spacerang": [15, 25], "locat": [15, 21, 22, 36, 37, 39], "exactli": 15, "nuclei": [15, 17, 20, 21, 22, 23, 26, 27, 28, 29, 30, 31, 32, 33, 34, 36, 37], "posit": [15, 18, 19, 26, 27, 28, 29, 30, 36, 37, 40], "y": [15, 18, 19, 26, 32, 36, 37, 38, 39, 40], "gener": [15, 18, 36, 38, 39, 40], "By": 15, "those": [15, 36, 37], "mean_grai": [15, 36, 37, 38, 39, 40], "std_grai": [15, 36, 37, 38, 39, 40], "entropy_img": [15, 36, 37, 38, 39, 40], "mean_r": [15, 36, 37, 38, 39, 40], "mean_g": [15, 36, 37, 38, 39, 40], "mean_b": [15, 36, 37, 38, 39, 40], "std_r": [15, 36, 37, 38, 39, 40], "std_g": [15, 36, 37, 38, 39, 40], "std_b": [15, 36, 37, 38, 39, 40], "headless": 15, "one": [15, 22, 33, 34], "includ": [15, 18, 26, 33, 34, 36, 39], "consist": [15, 39], "self": [15, 26, 36, 37, 38, 39], "highli": [15, 36, 37], "variabl": [15, 20, 21, 22, 23, 36, 37], "set": [15, 18, 22, 24, 36, 37, 38, 39], "further": [15, 33, 34], "set_genes_for_predict": [15, 36, 37, 38, 39], "predict": 15, "specifi": [15, 21, 22, 36], "mode": [15, 36, 37, 38, 39], "reduc": 15, "mix": 15, "allow": [15, 22], "futur": 15, "creat": [15, 21, 22, 33, 34, 36, 38, 39], "new": [15, 21, 22, 26, 35], "instanc": 15, "copi": [15, 33, 34, 40], "deep": [15, 33, 34], "get_reduced_gen": 15, "keep": 15, "min_mean_express": 15, "get": [15, 26, 38], "were": [15, 38], "train": 15, "vae": 15, "becaus": [15, 39], "mai": [15, 38], "reconstruct": 15, "faithfulli": 15, "same": [15, 21, 22, 33, 34, 36, 37, 38], "extent": 15, "therefor": 15, "high": [15, 39], "qualiti": [15, 36, 37, 38, 39], "measur": 15, "cosin": 15, "similar": [15, 38], "awar": 15, "used_for_va": [15, 36, 37, 38, 39, 40], "used_for_reduc": [15, 36, 37, 38, 39, 40], "subset": 15, "fraction": [15, 33, 34], "rank": [15, 36], "accord": [15, 26, 33, 34, 36, 37, 38, 39], "consid": 15, "log": [15, 36, 37, 38, 39, 40], "transform": [15, 39], "mark": 15, "classmethod": 15, "load_gen": 15, "genes_file_path": 15, "convent": 15, "match": [15, 36, 37, 38], "load_param": 15, "merg": 15, "run_param": 15, "graph_param": 15, "file_nam": 15, "layer_nam": 15, "rel": 15, "load_vae_model": 15, "model_path": 15, "pre": [15, 26, 36, 37, 39], "encod": 15, "decod": 15, "subdirectori": 15, "filenam": [15, 40], "_vae_encod": 15, "h5": 15, "_vae_decod": 15, "predict_gene_express": [15, 36, 37, 38, 39], "step": [15, 25, 33, 34, 36, 37], "updat": 15, "set_param": [15, 36, 37, 38, 39], "burn": [15, 37], "effect": [15, 37], "4": [15, 33, 34, 36, 37, 38, 39, 40], "initi": 15, "6": [15, 21, 22, 36, 37, 38, 39, 40], "clean": 15, "up": [15, 18, 36, 37], "accept": [15, 41], "For": [15, 22, 35, 36, 37, 38, 39, 40], "detail": 15, "descript": 15, "markov_graph_diffus": 15, "estimate_expression_markov_graph_diffus": 15, "underli": 15, "implement": 15, "prepare_input": [15, 36, 37, 38, 39], "mapping_margin": [15, 36, 37, 38, 39], "spot_identifi": 15, "spot_barcod": [15, 36, 37, 38, 39, 40], "estim": [15, 32, 36, 37, 38, 39], "wise": 15, "In": [15, 33, 34, 36, 37, 38, 39, 40], "outlier": [15, 26, 32], "remov": [15, 26, 32, 36], "its": 15, "nearest": [15, 32, 33, 34, 36, 37], "neighbor": [15, 33, 34, 36, 37], "second": [15, 33, 34, 37], "map": [15, 26, 36, 37, 38, 39, 40], "lastli": 15, "heterogen": [15, 33, 34, 36, 37, 38, 39], "margin": 15, "attempt": 15, "within": [15, 21, 22, 33, 34, 36, 37, 38, 39], "almost": 15, "all": [15, 19, 20, 23, 36, 37, 38], "identifi": 15, "decreas": 15, "would": 15, "like": [15, 39], "elimin": [15, 33, 34, 36, 37, 38, 39], "isol": 15, "prepare_recip": 15, "appropri": [15, 36], "used_for_predict": [15, 36, 37, 38, 39, 40], "ignor": [15, 37, 38], "both": [15, 21, 33, 34, 37, 39], "rest": 15, "specif": [15, 37], "appli": [15, 18, 19, 36, 37], "sanity_check": 15, "saniti": 15, "check": [15, 36, 38, 39], "verifi": 15, "necessari": 15, "correctli": [15, 35], "befor": [15, 36], "otherwis": 15, "exclud": 15, "conn_csr_matrix": [15, 36, 37, 39], "state": 15, "set_cell_features_csv_path": 15, "obtain": 15, "extract": [15, 26, 32, 33, 34, 36], "set_cell_features_list": 15, "genes_selection_kei": [15, 36, 37, 38, 39], "highly_vari": [15, 37, 40], "configur": 15, "n_neighbor": [15, 36, 37, 38, 39], "obs_kei": 15, "reduced_dimension_transcriptome_obsm_kei": [15, 36, 37, 39], "dimens": 15, "x_pca": [15, 37, 38, 39, 40], "reduced_dimension_transcriptome_obsm_dim": 15, "geom_morph_ratio": [15, 36, 37, 38, 39], "ratio": 15, "geometr": 15, "morpholog": [15, 33, 34, 36, 38, 39], "geom_constraint": [15, 36, 37, 39], "constraint": 15, "snn_threshold": 15, "threshold": [15, 40], "share": [15, 33, 34], "node_features_obs_list": [15, 36, 37, 38, 39], "node": [15, 33, 34], "spot_heterogen": [15, 36, 37, 38, 39, 40], "balance_cell_qu": 15, "balanc": 15, "bcq_iqr": 15, "interquartil": 15, "15": [15, 22, 36, 37, 38, 39, 40], "85": [15, 40], "preferential_flow": 15, "preferenti": 15, "flow": [15, 36, 37, 38, 39], "weigh_cel": 15, "weigh": [15, 36, 37, 38, 39], "idea": 15, "give": 15, "higher": 15, "surround": 15, "smoothing_scal": [15, 36, 37, 38, 39], "when": [15, 26], "stai": 15, "8": [15, 18, 19, 21, 22, 36, 37, 38, 39, 40], "defin": [15, 33, 34, 36, 37], "lambda": [15, 40], "cdot": 15, "ident": 15, "connect": [15, 33, 34, 36, 37, 39], "inflation_percentag": [15, 36, 37, 38, 39], "percentag": 15, "revers": 15, "forward": 15, "enabl": [15, 33, 34], "everi": [15, 33, 34, 40], "iter": [15, 38], "t_": 15, "rev": 15, "mu": 15, "text": [15, 18, 19, 36, 37, 38], "scipi": [15, 21, 22, 36], "csr_matrix": 15, "doe": [15, 18], "exist": [15, 26], "obsp": [15, 36, 37, 38, 39, 40], "els": 15, "forc": [15, 36, 37, 39], "regardless": 15, "alreadi": 15, "burn_in_step": 15, "period": 15, "is_rawcount": [15, 36, 37, 38, 39], "raw": 15, "regulate_expression_mean": [15, 36, 37, 38, 39], "stochastic_expression_neighbors_level": [15, 36, 37, 38, 39], "stochast": 15, "n_iter": [15, 36, 37, 38, 39], "conn_kei": 15, "snn": [15, 33, 34, 36, 37, 38, 39, 40], "write_freq": [15, 36, 37, 38, 39], "frequenc": 15, "write": [15, 39], "disk": 15, "out_prefix": [15, 36, 37, 38, 39], "sample_predicted_expression_fluctuation_scal": 15, "fluctuat": 15, "smooth_predicted_expression_step": [15, 36, 37, 39], "save_chain": 15, "mcmc": [15, 38], "chain": 15, "n_job": [15, 36, 37, 38, 39], "job": 15, "adjust_cell_network_by_transcriptome_scal": [15, 36, 37, 39], "adjust": [15, 37], "markov_graph_diffusion_initi": 15, "vae_train": 15, "vae_genes_set": 15, "train_va": 15, "usag": 15, "visualize_cell_network": 15, "intern": 15, "call": 15, "plot_cell_graph": 15, "see": [15, 35], "displai": [15, 17, 20, 21, 22, 23], "write_adata": 15, "write_param": 15, "written": [15, 32, 35], "im": 16, "roi_polygon": [16, 36], "baseline_polygon": 16, "lw": [16, 18, 19, 36], "2d": 16, "geometri": [16, 36], "line": [16, 18, 19, 24], "width": [16, 17, 18, 19, 20, 21, 22, 23, 24, 36], "cluster_labels_list": 17, "image_s": [17, 20, 23], "cells_pixel": [17, 20, 23, 36], "multiple_kwd": [17, 20], "color": [17, 20, 21, 22, 23, 24, 26, 32, 36, 37, 38, 39, 40], "nucleu": [17, 20, 23], "height": [17, 20, 21, 22, 23], "repres": [17, 18, 20, 21, 22, 23, 33, 34], "pixel": [17, 20, 23, 32, 36, 37, 39], "multipl": [17, 20], "return_fig": [17, 20, 21, 22, 23, 36], "show": [17, 20, 21, 22, 23, 36, 37, 38, 39, 40], "ax": [17, 19, 20, 21, 22, 23, 24, 36, 37, 40], "figur": [17, 20, 21, 22, 23, 24, 33, 34, 36], "matplotlib": [17, 18, 19, 20, 21, 22, 23, 36, 37, 38, 39, 40], "_subplot": [17, 20, 21, 22, 23], "axessubplot": [17, 20, 21, 22, 23], "cmap": [18, 19, 21, 22, 36, 37, 38, 40], "orang": 18, "blue": [18, 21], "text_offset_x": [18, 19], "08": [18, 19, 38, 39, 40], "text_offset_i": [18, 19], "text_siz": [18, 19], "subplots_kwd": 18, "log2foldchang": [18, 19], "row": [18, 19, 38, 40], "down": 18, "colormap": [18, 19, 21, 22, 24], "numer": [18, 19, 32], "offset": [18, 19], "pyplot": [18, 36, 37, 38, 39, 40], "subplot": [18, 36, 37, 40], "separ": 18, "directli": [18, 36, 37], "plt": [18, 36, 37, 38, 39, 40], "assum": [18, 21, 22], "gene1": 18, "gene2": 18, "etc": [18, 21, 22], "up_gen": 18, "gene3": 18, "gene5": 18, "down_gen": 18, "gene4": 18, "gene6": 18, "fring": 18, "custom": [18, 21, 22, 32], "red": [18, 21], "green": 18, "viridi": [19, 22, 24, 36], "annot_bbox": 19, "axi": 19, "vars_list": [20, 21], "vars_expression_arrai": 20, "global_norm": [20, 23], "n_variabl": 20, "across": [20, 23], "img_masks_list": 21, "vor": [21, 22], "palett": [21, 36, 38], "tab20": 21, "full_res_im": [21, 22, 36], "roi_tupl": [21, 22, 36], "img_alpha": [21, 22, 36], "figsiz": [21, 22, 24, 36, 37, 40], "dpi": [21, 22, 36, 37, 38, 39], "show_legend": 21, "legend_loc": 21, "show_cbar": [21, 22, 36], "imshow_kwd": [21, 22], "mask": [21, 22, 29, 31, 36, 37], "fill": [21, 22, 36], "voronoi": [21, 22], "diagram": [21, 22], "bottom": [21, 22], "alpha": [21, 22, 24, 36, 38, 39], "transpar": [21, 22], "fulli": [21, 22], "opaqu": [21, 22], "inch": [21, 22], "dot": [21, 22], "legend": [21, 36], "indic": [21, 26], "colorbar": [21, 22], "without": [21, 22, 36, 37, 39], "imshow": [21, 22], "vmin": [21, 22, 36, 37, 38], "vmax": [21, 22, 36, 37, 38], "entir": [21, 22], "code": 21, "either": [21, 26, 36, 37], "singl": [21, 23], "cannot": 21, "simultan": 21, "also": [21, 22, 36, 38], "gene_x": [21, 22], "gene_i": [21, 22], "40": [21, 22, 36, 37, 38, 39, 40], "gene_a": 21, "gene_b": 21, "use_global_vmax": [21, 22], "img_mask": 22, "500": [22, 26, 36], "cbar_loc": 22, "04": [22, 36, 38, 39, 40], "02": [22, 39, 40], "05": [22, 36, 39, 40], "overlai": 22, "use_global_vmin": 22, "global": 22, "respect": 22, "var_express": 23, "single_kwd": 23, "1d": 23, "ad_spot": [24, 36, 37], "spot_scal": 24, "spot_cmap": 24, "spot_color_obs_kei": 24, "spot_facecolor": 24, "spot_alpha": 24, "spot_linewidth": 24, "sc_kwarg": 24, "factor": [24, 33, 34, 39], "face": 24, "depend": [24, 36], "10x": [25, 33, 34, 36, 37], "process_transcriptom": [25, 37], "perform_qc": [25, 37], "min_cel": 25, "min_count": 25, "1000": [25, 31], "max_count": 25, "35000": 25, "max_mt_pct": 25, "max_rb_pct": 25, "basic": [25, 37], "preprocess": [25, 26, 32, 38], "done": [25, 36, 40], "seurat": 25, "veri": 25, "http": [25, 36, 38], "tutori": [25, 36, 37, 38], "readthedoc": 25, "io": 25, "en": 25, "latest": 25, "html": 25, "color_imag": [26, 32], "nuclei_seg_path": [26, 32, 36, 39], "nuclei_seg_format": [26, 32, 36, 39], "nuclei_remove_outli": 26, "context_s": [26, 32], "now": [26, 36, 37, 38, 39], "cellpos": [26, 27, 30, 31, 32, 36, 37], "mask_array_npz": [26, 30, 32, 36, 39], "cellprofil": [26, 28, 30, 32], "pair": 26, "tif": [26, 36, 37, 38], "wsi_1": 26, "stardist": [26, 31, 39], "tile_s": [26, 31], "min_siz": 26, "flow_threshold": 26, "prob_thresh": 26, "get_bbox": 26, "bound": [26, 32], "box": [26, 32], "lb": 26, "corner": 26, "ub": 26, "exclus": 26, "combin": [26, 40], "must": 26, "join": [26, 36, 37, 38, 39], "rais": 26, "valueerror": 26, "replac": 26, "extend": [26, 36], "nuclei_segment": 26, "nuclei_seg": 26, "nuclei_segmentation_from_image_arrai": 26, "stain": [26, 31, 36, 37], "output_path": 26, "tile": [26, 31], "png": 26, "nuclei_path": [27, 28, 29, 30], "nuclei_centroid": [27, 28, 29, 30], "npz": [29, 31, 36, 37, 38, 39], "source_format": 30, "segment_kwd": 31, "h": [31, 36, 37], "histocartographi": 31, "bbox": 32, "nuclei_centroids_path": 32, "extract_image_feature_custom_func": 32, "remove_outli": 32, "lower_left": 32, "upper_right": 32, "centroid": 32, "squar": [32, 36], "patch": [32, 36], "around": 32, "unit": [32, 36], "median": [32, 36], "min": [32, 37, 38], "max": 32, "wai": [32, 33, 34], "take": [32, 36, 37, 39], "rapidli": [33, 34], "advanc": [33, 34], "landscap": [33, 34], "biolog": [33, 34], "pathologi": [33, 34], "integr": [33, 34], "histolog": [33, 34], "ha": [33, 34], "emerg": [33, 34], "critic": [33, 34], "necess": [33, 34], "ai": [33, 34], "modal": [33, 34], "infrastructur": [33, 34], "seamlessli": [33, 34, 36], "incorpor": [33, 34, 37], "overcom": [33, 34], "limit": [33, 34, 36, 37, 39], "st": [33, 34], "emploi": [33, 34], "anti": [33, 34], "shrink": [33, 34], "markov": [33, 34, 36], "diffus": [33, 34], "notabl": [33, 34], "leverag": [33, 34], "achiev": [33, 34], "deconvolut": [33, 34], "meanwhil": [33, 34], "extens": [33, 34], "framework": [33, 34], "analys": [33, 34, 35, 36], "sub": [33, 34], "cellular": [33, 34], "suffer": [33, 34], "dropout": [33, 34], "rate": [33, 34], "low": [33, 34, 36, 37, 38, 39], "coverag": [33, 34], "well": [33, 34], "imperfect": [33, 34], "enhanc": [33, 34], "improv": [33, 34], "recov": [33, 34], "learn": [33, 34], "term": [33, 34], "ii": [33, 34], "combinatori": [33, 34], "space": [33, 34, 36, 37, 39], "construct": [33, 34, 36, 37, 38, 39], "iii": [33, 34], "transit": [33, 34, 36, 37, 38, 39], "probabl": [33, 34], "system": [33, 34], "iv": [33, 34], "nn": [33, 34], "graph": [33, 34], "stand": [33, 34], "reflect": [33, 34], "environ": [33, 34, 36], "physic": [33, 34, 36], "stabil": [33, 34], "thei": [33, 34], "homogen": [33, 34, 36, 37, 38, 39], "asymmetr": [33, 34], "correct": [33, 34], "enclos": [33, 34], "illustr": [33, 34], "refin": [33, 34], "elev": [33, 34], "establish": [33, 34], "standard": [33, 34, 39], "insight": [33, 34], "cover": [33, 34], "immun": [33, 34, 36], "respons": [33, 34, 36], "diseas": [33, 34, 40], "associ": [33, 34, 39], "detect": [33, 34, 36, 37, 39], "transcript": [33, 34], "variat": [33, 34], "depth": [33, 34], "third": [33, 34], "standalon": [33, 34], "applic": [33, 34], "tool": [33, 34], "releas": [34, 35], "frequent": 34, "ask": 34, "question": 34, "api": 34, "olfactori": 34, "bulb": 34, "ductal": 34, "carcinoma": 34, "situ": 34, "failur": [34, 40], "video": [34, 38], "ubuntu": 35, "rocki": 35, "11": [35, 36, 37, 38, 39, 40], "conda": 35, "abov": 35, "newli": 35, "under": 35, "licens": 35, "pypi": 35, "At": 35, "moment": 35, "download": [35, 36, 37, 38, 39, 40], "zip": 35, "machin": 35, "local": [35, 36, 37, 38, 39, 40], "With": 35, "To": 35, "c": [35, 36, 39, 40], "print": [35, 36, 40], "__version__": 35, "success": 35, "page": [36, 37, 38, 39, 40], "jupyt": [36, 37, 38, 39, 40], "notebook": [36, 37, 38, 39, 40], "here": [36, 37, 38, 39, 40], "unbias": 36, "screen": 36, "breast": 36, "cancer": [36, 39], "reveal": [36, 37], "invas": 36, "ffpe": 36, "websit": [36, 37], "guid": [36, 37, 38, 39, 40], "sy": [36, 37, 39, 40], "o": [36, 37, 38, 39, 40], "datetim": [36, 37, 38, 39, 40], "logger": [36, 37, 38, 39], "getlogg": [36, 37, 38, 39], "setlevel": [36, 37, 38, 39], "info": [36, 37, 38, 39], "basicconfig": [36, 37, 38, 39], "levelnam": [36, 37, 38, 39], "messag": [36, 37, 38, 39], "f": [36, 37, 38, 39, 40], "time": [36, 37, 38, 39, 40], "2023": [36, 37, 38], "12": [36, 37, 38, 39, 40], "13": [36, 37, 38, 39, 40], "16": [36, 38, 39, 40], "53": [36, 40], "118962": 36, "config": [36, 37, 38, 39, 40], "inlinebackend": [36, 37, 38, 39, 40], "figure_format": [36, 37, 38, 39, 40], "retina": [36, 37, 38, 39, 40], "seaborn": [36, 37, 39, 40], "sn": [36, 38, 39, 40], "set_figure_param": [36, 37, 38, 39], "80": [36, 37, 39, 40], "dpi_sav": [36, 37, 38, 39], "300": [36, 37, 38, 39], "verbos": [36, 37, 38, 39], "error": [36, 37, 38, 39], "finest": [36, 37, 38, 39, 40], "numexpr": [36, 37, 39], "util": [36, 37, 39, 40], "34": [36, 37, 38, 39, 40], "numexpr_max_thread": [36, 37, 39], "enforc": [36, 37, 39], "safe": [36, 37, 39], "thread": [36, 37, 39], "wsi_": [36, 39], "outcom": [36, 37], "dcis_10x": 36, "visium_ffpe_human_breast_cancer_imag": 36, "notic": [36, 37], "long": [36, 37], "gpu": [36, 37, 39], "n_pixel_row": [36, 37], "n_pixel_col": [36, 37], "ll": [36, 37], "skip": [36, 37, 38, 39], "echo": [36, 37], "handcraft": 36, "cell_mask_path": [36, 37, 38, 39], "wsi_dcis_10x": 36, "cell_mask": [36, 37], "23": [36, 37, 38, 40], "37": [36, 39, 40], "76396": 36, "38": [36, 40], "76359": 36, "kept": [36, 38], "lt": [36, 37, 38, 39], "0x107c40900": 36, "gt": 36, "112": 36, "center": 36, "grai": 36, "00": [36, 37, 38, 39], "16574": 36, "04it": 36, "rgb": 36, "33": [36, 38, 40], "2297": 36, "83it": 36, "qc": 36, "standar": [36, 37], "ranger": [36, 37, 39], "visium_dir": [36, 37], "scalefactor": [36, 37], "finish": [36, 37, 38, 39], "origin": [36, 37, 38], "spatial_dcis_10x": 36, "outdir": [36, 37, 39], "getcwd": [36, 37, 39, 40], "image_process_dir": [36, 37, 39], "cell_feature_path": [36, 37, 39], "spatial_dir": [36, 39], "approach": [36, 37], "start": [36, 37, 38, 39], "point": [36, 37], "7": [36, 37, 38, 39, 40], "dci": 36, "54": [36, 40], "node_feat": [36, 37, 38, 39], "39": [36, 37, 38, 39, 40], "closest": [36, 37, 38, 39], "n_ob": [36, 37, 38, 39, 40], "n_var": [36, 37, 38, 39, 40], "76344": 36, "16784": 36, "ob": [36, 37, 38, 39, 40], "in_tissu": [36, 37, 39], "array_row": [36, 37, 39], "array_col": [36, 37, 39], "n_gene": [36, 38, 40], "n_genes_by_count": [36, 39], "total_count": [36, 39], "total_counts_mt": [36, 39], "pct_counts_mt": [36, 39], "gene_id": [36, 37, 39], "feature_typ": [36, 37, 39], "mt": [36, 38, 39, 40], "n_cells_by_count": [36, 39], "mean_count": [36, 39], "pct_dropout_by_count": [36, 39], "cell_image_prop": [36, 37, 38, 39, 40], "There": [36, 38], "75117": 36, "sake": [36, 37], "few": 36, "vegfa": [36, 40], "fgfr4": 36, "tpd52": 36, "grb7": 36, "jup": 36, "scgb2a2": 36, "kank1": 36, "esr1": 36, "tfrc": 36, "erbb2": 36, "ensg00000072274": 36, "grch38": 36, "1847": 36, "779190": 36, "26": [36, 40], "648133": 36, "6998": 36, "ensg00000160867": 36, "165": 36, "094122": 36, "93": [36, 40], "447180": 36, "237": 36, "ensg00000112715": 36, "1900": 36, "851866": 36, "24": [36, 40], "543288": 36, "9699": 36, "ensg00000091831": 36, "166": 36, "069102": 36, "407466": 36, "174": 36, "ensg00000076554": 36, "2016": 36, "621922": 36, "19": [36, 39, 40], "936458": 36, "14156": 36, "ensg00000107104": 36, "818": 36, "499603": 36, "67": [36, 40], "513900": 36, "1258": 36, "ensg00000110484": 36, "2213": 36, "17": [36, 37, 39, 40], "403097": 36, "112788": 36, "43821": 36, "ensg00000141736": 36, "2417": 36, "22": [36, 38, 40], "986498": 36, "011120": 36, "57880": 36, "ensg00000141738": 36, "1411": 36, "008737": 36, "43": [36, 38, 39, 40], "963463": 36, "5058": 36, "ensg00000173801": 36, "1758": 36, "829230": 36, "182685": 36, "7124": 36, "27": [36, 40], "recalcul": [36, 37, 39], "28": [36, 38, 40], "add": [36, 37, 38, 39], "snn_connect": [36, 37, 38, 39, 40], "snn_knn_connect": [36, 37, 38, 40], "29": [36, 37, 40], "promot": [36, 37, 38, 39], "less": [36, 37, 38], "snn_transition_matrix": [36, 37, 38, 39, 40], "categor": [36, 37, 38, 39], "48": [36, 38, 40], "ad_thor": [36, 37, 38, 39, 40], "finest_20_samp1": 36, "node_weight": [36, 37, 38, 39, 40], "14": [36, 37, 38, 39, 40], "read_h5ad": [36, 37, 39, 40], "pl": [36, 37, 38, 39, 40], "p99": [36, 37, 38], "frameon": [36, 37, 38], "spot_siz": [36, 37, 38, 39], "50": [36, 38, 39, 40], "context": 36, "2747": 36, "link": [36, 38], "part": [36, 39], "case": [36, 37], "studi": [36, 37, 40], "stat": 36, "mpl": 36, "pil": [36, 39], "convert_pixel_to_micron_visium": [36, 40], "get_roi_tuple_from_polygon": 36, "get_adata_layer_arrai": [36, 39], "annotate_roi": 36, "get_nuclei_pixel": [36, 39], "single_molecul": [36, 39], "anali": [36, 38], "get_pathway_scor": [36, 38], "18": [36, 37, 39, 40], "fullres_im": 36, "thor_dcis_10x": 36, "cell_data_thor": 36, "76320": 36, "2748": 36, "tumor_region": 36, "tumor_region_ext": 36, "copy_vari": 36, "copy_variation_color": 36, "hvg": [36, 37, 40], "leiden": [36, 40], "leiden_color": 36, "pca": [36, 37, 39], "recluster_normal_color": 36, "tumor_cluster_cnv_color": 36, "tumor_normal_subtumor_color": 36, "tumor_region_boundari": 36, "umap": 36, "non": 36, "tab20b": 36, "titl": [36, 38, 40], "major": 36, "continuous_palett": [36, 37, 38], "blueyellow": [36, 37, 38], "linearsegmentedcolormap": [36, 37, 38], "from_list": [36, 37, 38], "my_cmap": [36, 38], "256": [36, 38], "21": [36, 38, 40], "close": 36, "explor": 36, "dedic": 36, "webapp": 36, "mjolnir": [36, 38], "agoko": 36, "nv": 36, "belgium": 36, "matric": [36, 39], "tumor1": 36, "tumor1_polygon": 36, "extend_pixel": 36, "cellmask": 36, "microperpixel": 36, "expression_vector": 36, "add_scalebar": 36, "um": 36, "roi_squar": 36, "9000": 36, "7900": 36, "10400": 36, "8900": 36, "fig": [36, 37, 40], "vector_friendli": 36, "fontsiz": 36, "atm": 36, "xlabel": 36, "spatial1": 36, "ylabel": 36, "spatial2": 36, "g1": 36, "g2": 36, "region_col": 36, "vstack": 36, "kernel": 36, "gaussian_kd": 36, "ax1": 36, "jointplot": 36, "kind": 36, "kde": 36, "ax_joint": 36, "cla": 36, "sca": 36, "scatterplot": 36, "jet": 36, "set_xlabel": 36, "set_ylabel": 36, "set_xlim": 36, "set_ylim": 36, "sever": 36, "background": [36, 40], "ad1": 36, "color_map": 36, "rdylgn_r": 36, "alpha_img": [36, 38], "decoupl": [36, 38], "msigdb": [36, 38], "while": 36, "internet": 36, "minut": 36, "get_resourc": [36, 38], "collect": [36, 38], "duplic": [36, 38], "act": [36, 38], "max_valu": 36, "omnipathdb": [36, 38], "org": [36, 38], "queri": [36, 38], "enzsub": [36, 38], "complex": [36, 38], "intercel": [36, 38], "about": [36, 38], "protein": [36, 38, 39], "resourc": [36, 38], "ora": [36, 38], "mat": [36, 38], "49": [36, 37, 38, 40], "1864": 36, "33it": 36, "31": [36, 38, 40], "example_pathwai": 36, "hallmark_dna_repair": 36, "hallmark_e2f_target": 36, "hallmark_estrogen_response_earli": 36, "hallmark_il6_jak_stat3_sign": 36, "ncol": [36, 37, 38], "colorbar_loc": [36, 37, 38], "order": 36, "simpli": 36, "prepare_and_run_copykat": 36, "bc": 36, "32": [36, 40], "facecolor": [36, 37], "white": 36, "set_xtick": 36, "set_ytick": 36, "signatur": 36, "final": 36, "sinc": 36, "relat": 36, "marker": 36, "tls_list_immun": 36, "igha1": 36, "ighg1": 36, "ighg2": 36, "ighg3": 36, "ighg4": 36, "ighgp": 36, "ighm": 36, "igkc": 36, "iglc1": 36, "iglc2": 36, "iglc3": 36, "jchain": 36, "cd79a": 36, "fcrl5": 36, "mzb1": 36, "ssr4": 36, "xbp1": 36, "trbc2": 36, "il7r": 36, "cxcl12": 36, "lum": 36, "c1qa": 36, "c7": 36, "cd52": 36, "apo": 36, "pltp": 36, "ptgd": 36, "pim2": 36, "derl3": 36, "score_gen": 36, "ctrl_size": 36, "len": 36, "gene_pool": 36, "n_bin": 36, "score_nam": 36, "tls_score_immun": 36, "random_st": 36, "use_raw": [36, 38], "visium_ffpe_human_breast_canc": 36, "tissue_hires_scalef": 36, "tumor_bord": 36, "border": 36, "item": 36, "zorder": 36, "55": [36, 40], "outward": 36, "35": [36, 40], "tls_clone_stats1": 36, "groupbi": 36, "aggreg": 36, "sort_valu": 36, "ascend": 36, "36": [36, 40], "tumor_col": 36, "df": 36, "loc": 36, "spine": 36, "set_color": 36, "boxplot": 36, "whi": 36, "95": [36, 40], "dodg": 36, "fliersiz": 36, "b": 36, "get_facecolor": 36, "set_facecolor": 36, "stripplot": 36, "jitter": 36, "_remove_legend": 36, "get_legend": 36, "categori": 36, "parsabl": 36, "date": 36, "cast": 36, "structur": 37, "adult": 37, "893931": 37, "warn": [37, 38], "filterwarn": [37, 38], "mob_10x": 37, "visium_mouse_olfactory_bulb_imag": 37, "folder": [37, 39], "10xolfactori": 37, "tran": 37, "adata_spot": [37, 39], "normalize_tot": [37, 38, 39], "target_sum": [37, 39], "1e4": 37, "log1p": [37, 38, 39, 40], "write_h5ad": 37, "wsi_mob_10x": 37, "spatial_mob_10x": 37, "mob": 37, "40543": 37, "32285": 37, "eom": 37, "uchl1": 37, "pcp4l1": 37, "col6a1": 37, "tbx21": 37, "slc17a6": 37, "bmp7": 37, "camk2a": 37, "cystm1": 37, "penk": 37, "gria1": 37, "nap1l5": 37, "serpine2": 37, "kctd12": 37, "pde5a": 37, "syt7": 37, "vtn": 37, "ensmusg00000026249": 37, "ensmusg00000038370": 37, "ensmusg00000008999": 37, "ensmusg00000053965": 37, "ensmusg00000045573": 37, "ensmusg00000029223": 37, "ensmusg00000055430": 37, "ensmusg00000030500": 37, "ensmusg00000032446": 37, "ensmusg00000001119": 37, "ensmusg00000020524": 37, "ensmusg00000017344": 37, "ensmusg00000001444": 37, "ensmusg00000098557": 37, "ensmusg00000046727": 37, "ensmusg00000024617": 37, "ensmusg00000024743": 37, "vanilla": 37, "burnin": 37, "product": 37, "macbookpro": [37, 38], "m2": [37, 38], "pile": [37, 38], "67it": 37, "52": [37, 40], "808": 37, "finest_40_samp10": 37, "dispers": [37, 40], "dispersions_norm": [37, 40], "fw2": 37, "fireworks2": 37, "p5": 37, "p95": 37, "coolwarm": [37, 40], "set_titl": [37, 40], "mod_gen": 37, "yb": 37, "p2": 37, "p98": 37, "patient": [38, 39, 40], "fibrot": 38, "launch": 38, "natur": [38, 40], "alias": 38, "parentesi": 38, "manuscript": [38, 41], "appear": 38, "rz_gt_p2": 38, "rz1": 38, "rz_p11": 38, "rz2": 38, "gt_iz_p9": 38, "iz1": 38, "iz_p10": 38, "iz2": 38, "fz_gt_p19": 38, "fz1": 38, "fz_p18": 38, "fz2": 38, "927335": 38, "get_tf_act": 38, "total": 38, "six": 38, "exmapl": 38, "library_nam": 38, "fz_p20": 38, "visium_16_ck294": 38, "visium_14_ck292": 38, "visium_9_ck287": 38, "visium_7_ck285": 38, "visium_8_ck286": 38, "visium_5_ck283": 38, "below": 38, "he_imag": 38, "wsi_hf": 38, "features_": 38, "nucleis_": 38, "_mask": 38, "spatial_hf": 38, "_adata_spots_thor_process": 38, "rz": 38, "46": [38, 40], "32994": 38, "14467": 38, "n_count": [38, 39, 40], "percent": [38, 40], "adipocyt": [38, 40], "cardiomyocyt": [38, 40], "endotheli": [38, 39, 40], "fibroblast": [38, 39, 40], "lymphoid": [38, 40], "mast": [38, 40], "myeloid": [38, 40], "neuron": [38, 40], "pericyt": [38, 40], "cycl": [38, 40], "vsmc": [38, 40], "cell_type_origin": [38, 40], "assay_ontology_term_id": [38, 40], "cell_type_ontology_term_id": [38, 40], "development_stage_ontology_term_id": [38, 40], "disease_ontology_term_id": [38, 40], "ethnicity_ontology_term_id": 38, "is_primary_data": [38, 40], "organism_ontology_term_id": [38, 40], "sex_ontology_term_id": [38, 40], "tissue_ontology_term_id": [38, 40], "x_approximate_distribut": [38, 40], "x_normal": 38, "default_embed": [38, 40], "schema_vers": [38, 40], "x_spatial": [38, 40], "x_umap": [38, 40], "laptop": 38, "47": [38, 40], "optim": 38, "slow": 38, "60": [38, 40], "07": [38, 39, 40], "06": [38, 39, 40], "09": [38, 40], "63": 38, "03": [38, 39, 40], "finest_20": [38, 39], "pdgfra": [38, 39], "casq2": 38, "fbln2": 38, "pkp2": 38, "p1": 38, "go_bp": 38, "go_biological_process": 38, "gobp_": 38, "maff": 38, "embryo_develop": 38, "44": [38, 40], "positive_regulation_of_rna_metabolic_process": 38, "82": [38, 40], "regulation_of_epithelial_cell_differenti": 38, "94": [38, 40], "embryo_development_ending_in_birth_or_egg_hatc": 38, "108": 38, "in_utero_embryonic_develop": 38, "3838543": 38, "pramef22": 38, "positive_regulation_of_cell_population_prolif": 38, "3838544": 38, "apoptotic_process": 38, "3838545": 38, "regulation_of_cell_death": 38, "3838546": 38, "negative_regulation_of_developmental_process": 38, "3838547": 38, "negative_regulation_of_cell_death": 38, "620627": 38, "ptw_list": 38, "positive_regulation_of_t_cell_prolifer": 38, "positive_regulation_of_inflammatory_respons": 38, "positive_regulation_of_immune_effector_process": 38, "positive_regulation_of_b_cell_activ": 38, "positive_regulation_of_fibroblast_prolifer": 38, "collagen_fibril_organ": 38, "cardiac_muscle_contract": 38, "isin": [38, 40], "3181": 38, "gpr183": 38, "5388": 38, "ripk2": 38, "5673": 38, "12886": 38, "cebpb": 38, "14576": 38, "sphk1": 38, "3815299": 38, "sash3": 38, "3815331": 38, "3815499": 38, "3826247": 38, "tafazzin": 38, "3838037": 38, "hla": 38, "drb3": 38, "843": 38, "1175": 38, "86it": 38, "ora_estim": 38, "ora_pv": 38, "msigdb_ora_estim": 38, "msigdb_ora_pv": 38, "rainbow": 38, "net": 38, "get_collectri": 38, "organ": [38, 40], "split_complex": 38, "pmid": 38, "myc": 38, "tert": 38, "10022128": 38, "10491298": 38, "10606235": 38, "10637317": 38, "10723141": 38, "spi1": 38, "bglap": 38, "10022617": 38, "smad3": 38, "jun": 38, "10022869": 38, "12374795": 38, "smad4": 38, "stat5a": 38, "il2": 38, "10022878": 38, "11435608": 38, "17182565": 38, "17911616": 38, "22854263": 38, "43173": 38, "nfkb": 38, "hsa": 38, "mir": 38, "143": 38, "3p": 38, "19472311": 38, "43174": 38, "ap1": 38, "206": 38, "19721712": 38, "43175": 38, "5p": 38, "20813833": 38, "22387281": 38, "43176": 38, "224": 38, "23474441": 38, "23988648": 38, "43177": 38, "144": 38, "23546882": 38, "43178": 38, "ulm": 38, "659": 38, "20it": 38, "ulm_estim": 38, "ulm_pval": 38, "msigdb_ulm_estim": 38, "msigdb_ulm_pv": 38, "tf_list": 38, "myb": 38, "stat4": 38, "three": 38, "tip": 38, "bladder": 39, "2025": [39, 40], "951716": 39, "plot_spot": 39, "max_image_pixel": 39, "some": 39, "d1_johnson": 39, "_scan1": 39, "qptiff": 39, "tiff": 39, "nuclei_mask": 39, "pipelin": 39, "002um": 39, "_processed_002um": 39, "index_col": 39, "visiumhd_cell_map": 39, "hd2cell": 39, "adata_cel": 39, "assign": 39, "cellxspot": 39, "92514": 39, "2482662": 39, "10000": 39, "obs_nam": 39, "vim": 39, "vimentin": 39, "acta2": 39, "muscl": 39, "actin": 39, "\u03b1sma": 39, "cav1": 39, "caveolin": 39, "cav2": 39, "platelet": 39, "deriv": 39, "growth": 39, "receptor": 39, "cd34": 39, "molecul": 39, "gja1": 39, "gap": 39, "junction": 39, "connexin": 39, "kit": 39, "proto": 39, "oncogen": 39, "tyrosin": 39, "kinas": 39, "cdh11": 39, "cadherin": 39, "pdgfrb": 39, "beta": 39, "cspg4": 39, "chondroitin": 39, "sulfat": 39, "proteoglycan": 39, "ng2": 39, "pecam1": 39, "And": 39, "adhes": 39, "cd31": 39, "fap": 39, "tnc": 39, "tenascin": 39, "thy1": 39, "thy": 39, "surfac": 39, "antigen": 39, "cd90": 39, "s100a4": 39, "s100": 39, "calcium": 39, "bind": 39, "a4": 39, "fsp1": 39, "dll4": 39, "delta": 39, "canon": 39, "notch": 39, "ligand": 39, "ccr7": 39, "58": [39, 40], "knn_connect": 39, "57it": 39, "41": [39, 40], "seg_label": 39, "varm": 39, "pc": 39, "snn_distanc": 39, "knn_distanc": 39, "_finesst_20_result_002um": 39, "ad_hd": 39, "_processed_008um": 39, "built": 40, "021027": 40, "pengzhizhang": 40, "ccc_hf": 40, "ct": 40, "ccc": 40, "split_pathwai": 40, "plot_commot": 40, "cc": 40, "ligand_receptor_databas": 40, "cellchat": 40, "speci": 40, "tgfb1": 40, "tgfbr1_tgfbr2": 40, "tgfb": 40, "secret": 40, "tgfb2": 40, "tgfb3": 40, "acvr1b_tgfbr2": 40, "acvr1c_tgfbr2": 40, "1194": 40, "uts2b": 40, "uts2r": 40, "urotensin": 40, "1195": 40, "sstr5": 40, "1196": 40, "bag6": 40, "ncr3": 40, "bag": 40, "1197": 40, "lgals9": 40, "havcr2": 40, "galectin": 40, "1198": 40, "cd44": 40, "1199": 40, "pathways_dict": 40, "name_col_index": 40, "589": 40, "flt1": 40, "590": 40, "kdr": 40, "591": 40, "vegfb": 40, "592": 40, "vegfc": 40, "flt4": 40, "593": 40, "594": 40, "vegfd": 40, "595": 40, "596": 40, "pgf": 40, "597": 40, "flt1_kdr": 40, "598": 40, "flt4_kdr": 40, "599": 40, "gt_iz_p9_rep2": 40, "ad_spot_path": 40, "_adata_spots_filtered_ref": 40, "microns_per_pixel": 40, "re": 40, "spotdiameterinmicron": 40, "65": 40, "micron": 40, "distance_pixel": 40, "ad_comm": 40, "database_nam": 40, "df_ligrec": 40, "dis_thr": 40, "heteromer": 40, "pathway_sum": 40, "pathway_nam": 40, "plot_method": 40, "stream": 40, "background_legend": 40, "ndsize": 40, "grid_dens": 40, "summari": 40, "sender": 40, "alphabet": 40, "normalize_v": 40, "normalize_v_quantil": 40, "995": 40, "4000": 40, "5800": 40, "3000": 40, "5500": 40, "subsampl": 40, "gt_iz_p9_rep2_adata_cel": 40, "48556": 40, "3059": 40, "self_reported_ethnicity_ontology_term_id": 40, "donor_id": 40, "suspension_typ": 40, "cell_typ": 40, "assai": 40, "sex": 40, "self_reported_ethn": 40, "development_stag": 40, "imagerow": 40, "imagecol": 40, "feature_is_filt": 40, "feature_refer": 40, "feature_biotyp": 40, "spatial_dist": 40, "drop_dupl": 40, "ad_subsampl": 40, "8180": 40, "ad_thor_comm": 40, "expm1": 40, "df_deg": 40, "df_yhat": 40, "communication_deg_detect": 40, "receiv": 40, "01m": 40, "45": 40, "59": 40, "57": 40, "56": 40, "51": 40, "42": 40, "61": 40, "62": 40, "64": 40, "66": 40, "68": 40, "69": 40, "70": 40, "72": 40, "73": 40, "74": 40, "75": 40, "76": 40, "77": 40, "78": 40, "81": 40, "83": 40, "84": 40, "86": 40, "88": 40, "89": 40, "90": 40, "91": 40, "92": 40, "97": 40, "98": 40, "99": 40, "elaps": 40, "sequenti": 40, "df_deg_clu": 40, "df_yhat_clu": 40, "communication_deg_clust": 40, "deg_clustering_r": 40, "top_de_genes_vegf": 40, "plot_communication_dependent_gen": 40, "top_ngene_per_clust": 40, "heatmap_deg_vegf": 40, "pdf": 40, "font_scal": 40, "return_gen": 40, "def": 40, "adata_dis500": 40, "x_sc": 40, "sum": 40, "idx": 40, "argsort": 40, "scatter": 40, "toarrai": 40, "flatten": 40, "amount": 40, "neg": 40, "de": 40, "invert_yaxi": 40, "meltf": 40, "igfbp5": 40, "go": 41, "softwar": 41, "public": 41}, "objects": {"thor.analy": [[6, 0, 1, "", "SPARKX"], [7, 2, 1, "", "adata_to_mtx_conversion"], [8, 2, 1, "", "analyze_gene_expression_gradient"], [9, 2, 1, "", "compute_dge_between_regions"], [10, 2, 1, "", "get_pathway_score"], [11, 2, 1, "", "get_tf_activity"], [12, 2, 1, "", "prepare_and_run_copykat"], [13, 2, 1, "", "read_polygon_ROI"], [14, 2, 1, "", "run_commot"]], "thor.analy.SPARKX": [[6, 1, 1, "", "RUN_SPARKX_R"], [6, 1, 1, "", "compute_pattern_mean"], [6, 1, 1, "", "hierarchy_clustering"], [6, 1, 1, "", "kmeans_clustering"], [6, 1, 1, "", "load_gene_modules"], [6, 1, 1, "", "load_result"]], "thor": [[15, 0, 1, "", "fineST"]], "thor.fineST": [[15, 1, 1, "", "copy"], [15, 1, 1, "", "get_reduced_genes"], [15, 1, 1, "", "load"], [15, 1, 1, "", "load_genes"], [15, 1, 1, "", "load_params"], [15, 1, 1, "", "load_result"], [15, 1, 1, "", "load_vae_model"], [15, 1, 1, "", "predict_gene_expression"], [15, 1, 1, "", "prepare_input"], [15, 1, 1, "", "prepare_recipe"], [15, 1, 1, "", "sanity_check"], [15, 1, 1, "", "save"], [15, 1, 1, "", "set_cell_features_csv_path"], [15, 1, 1, "", "set_cell_features_list"], [15, 1, 1, "", "set_genes_for_prediction"], [15, 1, 1, "", "set_params"], [15, 1, 1, "", "vae_training"], [15, 1, 1, "", "visualize_cell_network"], [15, 1, 1, "", "write_adata"], [15, 1, 1, "", "write_params"]], "thor.pl": [[16, 2, 1, "", "annotate_ROI"], [17, 2, 1, "", "clusters"], [18, 2, 1, "", "deg"], [19, 2, 1, "", "fringe"], [20, 2, 1, "", "multi_molecules"], [21, 2, 1, "", "multiple"], [22, 2, 1, "", "single"], [23, 2, 1, "", "single_molecule"], [24, 2, 1, "", "spot_over"]], "thor.pp": [[25, 0, 1, "", "Spatial"], [26, 0, 1, "", "WholeSlideImage"], [27, 2, 1, "", "load_cellpose"], [28, 2, 1, "", "load_cellprofiler"], [29, 2, 1, "", "load_mask_npz"], [30, 2, 1, "", "load_nuclei"], [31, 2, 1, "", "nuclei_segmentation"], [32, 2, 1, "", "preprocess_image"]], "thor.pp.Spatial": [[25, 1, 1, "", "process_transcriptome"]], "thor.pp.WholeSlideImage": [[26, 1, 1, "", "get_bbox"], [26, 1, 1, "", "load_external_cell_features"], [26, 1, 1, "", "nuclei_segmentation"], [26, 1, 1, "", "process"], [26, 1, 1, "", "split"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:function"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "function", "Python function"]}, "titleterms": {"class": 0, "predict": [0, 36, 37, 38, 39], "silico": 0, "cell": [0, 33, 34, 36, 37, 38, 39, 40], "gene": [0, 36, 37, 38, 39], "express": [0, 36, 37, 38, 39], "preprocess": [0, 36, 37, 39, 40], "wsi": 0, "spatial": [0, 25, 33, 34, 37, 39], "transcriptom": [0, 33, 34, 36, 37, 39], "exampl": 0, "interfac": 0, "extern": 0, "r": 0, "packag": [0, 36, 37, 38, 39], "api": [0, 40], "advanc": [0, 36], "analys": [0, 38], "plot": 0, "frequent": 1, "ask": 1, "question": 1, "about": [2, 33, 34], "mjolnir": [2, 3, 4, 5, 33, 34], "instal": [3, 35], "prerequisit": [3, 35], "step": [3, 35], "1": [3, 33, 34, 35], "creat": [3, 35, 37], "conda": 3, "environ": [3, 35], "2": [3, 33, 34, 35, 39], "activ": [3, 38], "download": 3, "sourc": [3, 35], "code": [3, 35], "requir": [3, 33, 34], "depend": 3, "5": 3, "6": 3, "launch": 3, "webapp": 3, "local": 3, "test": 4, "data": [4, 33, 34, 37, 39, 40], "video": 5, "tutori": [5, 34], "thor": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40], "anali": [6, 7, 8, 9, 10, 11, 12, 13, 14], "sparkx": 6, "adata_to_mtx_convers": 7, "analyze_gene_expression_gradi": 8, "compute_dge_between_region": 9, "get_pathway_scor": 10, "get_tf_act": 11, "prepare_and_run_copykat": 12, "read_polygon_roi": 13, "run_commot": [14, 40], "finest": 15, "graph": [15, 37, 38, 39], "construct": 15, "paramet": 15, "transit": 15, "matrix": 15, "markov": [15, 37, 38, 39], "diffus": [15, 36, 37, 38, 39], "pl": [16, 17, 18, 19, 20, 21, 22, 23, 24], "annotate_roi": 16, "cluster": 17, "deg": [18, 40], "fring": 19, "multi_molecul": 20, "multipl": 21, "singl": [22, 33, 34], "single_molecul": 23, "spot_ov": 24, "pp": [25, 26, 27, 28, 29, 30, 31, 32], "wholeslideimag": 26, "load_cellpos": 27, "load_cellprofil": 28, "load_mask_npz": 29, "load_nuclei": 30, "nuclei_segment": 31, "preprocess_imag": 32, "For": [33, 34], "high": [33, 34], "resolut": [33, 34], "visium": [33, 34, 39], "hd": [33, 34, 39], "highlight": [33, 34], "level": [33, 34, 36, 37, 38, 39, 40], "infer": [33, 34, 38, 40], "platform": [33, 34], "comprehens": [33, 34], "imag": [33, 34, 36, 37], "genom": [33, 34], "visual": [33, 34, 36], "analysi": [33, 34, 36], "3": [33, 34, 35], "virtual": 35, "recommend": 35, "obtain": 35, "4": 35, "verifi": 35, "ductal": 36, "carcinoma": 36, "situ": 36, "run": [36, 39, 40], "import": [36, 37, 38, 39], "us": [36, 37, 38, 39, 40], "load": [36, 40], "result": [36, 39], "tissu": 36, "profil": [36, 39], "oncogen": 36, "tumor": 36, "suppressor": 36, "hallmark": 36, "pathwai": [36, 38, 40], "enrich": [36, 38], "copi": 36, "number": 36, "variat": 36, "tertiari": 36, "lymphoid": 36, "structur": 36, "tl": 36, "quantif": 36, "mous": 37, "olfactori": 37, "bulb": 37, "whole": 37, "slide": 37, "includ": 37, "segment": 37, "morpholog": 37, "featur": 37, "extract": 37, "If": 37, "specifi": 37, "save": 37, "directori": 37, "wsi_": 37, "sn": 37, "we": [37, 39, 40], "scanpi": 37, "gener": 37, "an": 37, "adata": 37, "spot": [37, 40], "qc": 37, "check": [37, 40], "few": 37, "human": [38, 40], "heart": [38, 40], "failur": 38, "transcript": 38, "factor": 38, "semi": 38, "supervis": 38, "annot": 38, "need": 39, "new": 39, "function": 39, "tailor": 39, "micromet": 39, "squar": 39, "bin": 39, "less": 39, "than": 39, "size": 39, "compar": 39, "between": 39, "visiumhd": 39, "008\u03bcm": 39, "close": 39, "actual": 39, "commun": 40, "ligand": 40, "receptor": 40, "databas": 40, "": 40, "commot": 40, "can": 40, "now": 40, "direct": 40, "vegf": 40, "signal": 40, "via": 40, "streamplot": 40, "With": 40, "origin": 40, "ar": 40, "observ": 40, "cross": 40, "vessel": 40, "region": 40, "base": 40, "initi": 40, "from": 40, "which": 40, "make": 40, "more": 40, "sens": 40, "along": 40, "releas": 41, "note": 41}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx.ext.todo": 2, "nbsphinx": 4, "sphinx": 60}, "alltitles": {"Classes": [[0, "classes"]], "Prediction of in silico cell gene expression": [[0, "prediction-of-in-silico-cell-gene-expression"]], "Preprocessing of WSI": [[0, "preprocessing-of-wsi"]], "Preprocessing of spatial transcriptomics": [[0, "preprocessing-of-spatial-transcriptomics"]], "Example interface with external R packages": [[0, "example-interface-with-external-r-packages"]], "API": [[0, "api"]], "Preprocessing": [[0, "preprocessing"], [36, "Preprocessing"], [37, "Preprocessing"]], "Advanced analyses": [[0, "advanced-analyses"]], "Plotting": [[0, "plotting"]], "Frequently asked questions": [[1, "frequently-asked-questions"]], "About Mjolnir": [[2, "about-mjolnir"]], "Mjolnir Installation": [[3, "mjolnir-installation"]], "Prerequisites": [[3, "prerequisites"], [35, "prerequisites"]], "Installation Steps": [[3, "installation-steps"], [35, "installation-steps"]], "1. Create a conda environment": [[3, "create-a-conda-environment"]], "2. Activate the environment": [[3, "activate-the-environment"]], "1. Download the source code": [[3, "download-the-source-code"]], "1. Install the required dependencies": [[3, "install-the-required-dependencies"]], "5. Install Mjolnir": [[3, "install-mjolnir"]], "6. Launch the webapp locally": [[3, "launch-the-webapp-locally"]], "Mjolnir test Data": [[4, "mjolnir-test-data"]], "Mjolnir video tutorials": [[5, "mjolnir-video-tutorials"]], "thor.analy.SPARKX": [[6, "thor-analy-sparkx"]], "thor.analy.adata_to_mtx_conversion": [[7, "thor-analy-adata-to-mtx-conversion"]], "thor.analy.analyze_gene_expression_gradient": [[8, "thor-analy-analyze-gene-expression-gradient"]], "thor.analy.compute_dge_between_regions": [[9, "thor-analy-compute-dge-between-regions"]], "thor.analy.get_pathway_score": [[10, "thor-analy-get-pathway-score"]], "thor.analy.get_tf_activity": [[11, "thor-analy-get-tf-activity"]], "thor.analy.prepare_and_run_copykat": [[12, "thor-analy-prepare-and-run-copykat"]], "thor.analy.read_polygon_ROI": [[13, "thor-analy-read-polygon-roi"]], "thor.analy.run_commot": [[14, "thor-analy-run-commot"]], "thor.fineST": [[15, "thor-finest"]], "Graph Construction Parameters": [[15, "graph-construction-parameters"]], "Transition Matrix Parameters": [[15, "transition-matrix-parameters"]], "Markov Diffusion Parameters": [[15, "markov-diffusion-parameters"]], "thor.pl.annotate_ROI": [[16, "thor-pl-annotate-roi"]], "thor.pl.clusters": [[17, "thor-pl-clusters"]], "thor.pl.deg": [[18, "thor-pl-deg"]], "thor.pl.fringe": [[19, "thor-pl-fringe"]], "thor.pl.multi_molecules": [[20, "thor-pl-multi-molecules"]], "thor.pl.multiple": [[21, "thor-pl-multiple"]], "thor.pl.single": [[22, "thor-pl-single"]], "thor.pl.single_molecule": [[23, "thor-pl-single-molecule"]], "thor.pl.spot_over": [[24, "thor-pl-spot-over"]], "thor.pp.Spatial": [[25, "thor-pp-spatial"]], "thor.pp.WholeSlideImage": [[26, "thor-pp-wholeslideimage"]], "thor.pp.load_cellpose": [[27, "thor-pp-load-cellpose"]], "thor.pp.load_cellprofiler": [[28, "thor-pp-load-cellprofiler"]], "thor.pp.load_mask_npz": [[29, "thor-pp-load-mask-npz"]], "thor.pp.load_nuclei": [[30, "thor-pp-load-nuclei"]], "thor.pp.nuclei_segmentation": [[31, "thor-pp-nuclei-segmentation"]], "thor.pp.preprocess_image": [[32, "thor-pp-preprocess-image"]], "About Thor": [[33, "about-thor"], [34, "about-thor"]], "For high spatial resolution data (Visium HD)": [[33, "for-high-spatial-resolution-data-visium-hd"], [34, "for-high-spatial-resolution-data-visium-hd"]], "Highlight 1 Cell-level transcriptome inference, no single-cell data required": [[33, "highlight-1-cell-level-transcriptome-inference-no-single-cell-data-required"], [34, "highlight-1-cell-level-transcriptome-inference-no-single-cell-data-required"]], "Highlight 2 Thor platform: Comprehensive image and genomics visualization and analysis": [[33, "highlight-2-thor-platform-comprehensive-image-and-genomics-visualization-and-analysis"], [34, "highlight-2-thor-platform-comprehensive-image-and-genomics-visualization-and-analysis"]], "Highlight 3 Mjolnir platform: Comprehensive image and genomics visualization and analysis": [[33, "highlight-3-mjolnir-platform-comprehensive-image-and-genomics-visualization-and-analysis"], [34, "highlight-3-mjolnir-platform-comprehensive-image-and-genomics-visualization-and-analysis"]], "Thor": [[34, null]], "Tutorials": [[34, null]], "Mjolnir visualization": [[34, null]], "Thor Installation": [[35, "thor-installation"]], "1. Create a virtual environment (recommended)": [[35, "create-a-virtual-environment-recommended"]], "2. Obtain the source code": [[35, "obtain-the-source-code"]], "3. Install Thor": [[35, "install-thor"]], "4. Verify the installation": [[35, "verify-the-installation"]], "Ductal carcinoma in situ": [[36, "Ductal-carcinoma-in-situ"]], "Run Thor": [[36, "Run-Thor"]], "Import the packages": [[36, "Import-the-packages"], [37, "Import-the-packages"], [38, "Import-the-packages"], [39, "Import-the-packages"]], "Predicting cell-level gene expression using Thor diffusion": [[36, "Predicting-cell-level-gene-expression-using-Thor-diffusion"]], "Advance analysis": [[36, "Advance-analysis"]], "Import packages": [[36, "Import-packages"]], "Load the image (for visualization) and Thor-predicted cell-level transcriptome result": [[36, "Load-the-image-(for-visualization)-and-Thor-predicted-cell-level-transcriptome-result"]], "Visualize genes at tissue and cell level": [[36, "Visualize-genes-at-tissue-and-cell-level"]], "Expression profile of oncogene and tumor suppressor gene": [[36, "Expression-profile-of-oncogene-and-tumor-suppressor-gene"]], "Hallmark pathway enrichment": [[36, "Hallmark-pathway-enrichment"]], "Copy number variation": [[36, "Copy-number-variation"]], "Tertiary Lymphoid Structures(TLS) quantification": [[36, "Tertiary-Lymphoid-Structures(TLS)-quantification"]], "Mouse olfactory bulb": [[37, "Mouse-olfactory-bulb"]], "Preprocessing the whole slide image, including cell segmentation and morphological feature extraction. If not specified, the segmentation data will be saved in a directory (created by Thor) WSI_{sn}.": [[37, "Preprocessing-the-whole-slide-image,-including-cell-segmentation-and-morphological-feature-extraction.-If-not-specified,-the-segmentation-data-will-be-saved-in-a-directory-(created-by-Thor)-WSI_{sn}."]], "Preprocessing spatial transcriptome. We used SCANPY to generate an adata for the spots including QC.": [[37, "Preprocessing-spatial-transcriptome.-We-used-SCANPY-to-generate-an-adata-for-the-spots-including-QC."]], "Predicting cell-level gene expression using Markov graph diffusion": [[37, "Predicting-cell-level-gene-expression-using-Markov-graph-diffusion"], [38, "Predicting-cell-level-gene-expression-using-Markov-graph-diffusion"], [39, "Predicting-cell-level-gene-expression-using-Markov-graph-diffusion"]], "Check the expression of a few genes.": [[37, "Check-the-expression-of-a-few-genes."]], "Human heart failure": [[38, "Human-heart-failure"]], "Pathway enrichment analyses": [[38, "Pathway-enrichment-analyses"]], "Transcription factor activity inference": [[38, "Transcription-factor-activity-inference"]], "Semi-supervised annotation": [[38, "Semi-supervised-annotation"]], "Run Thor on Visium HD data": [[39, "Run-Thor-on-Visium-HD-data"]], "Preprocessing cell-level spatial transcriptome.": [[39, "Preprocessing-cell-level-spatial-transcriptome."]], "We need to use a new function tailor to Visium HD 2 micrometer square bins data (less than cell size).": [[39, "We-need-to-use-a-new-function-tailor-to-Visium-HD-2-micrometer-square-bins-data-(less-than-cell-size)."]], "Compare gene expression profiles between the Thor results with VisiumHD 008\u03bcm data (close to the actual cell size).": [[39, "Compare-gene-expression-profiles-between-the-Thor-results-with-VisiumHD-008\u03bcm-data-(close-to-the-actual-cell-size)."]], "Cell cell communication": [[40, "Cell-cell-communication"]], "Load ligand-receptor database": [[40, "Load-ligand-receptor-database"]], "Human Heart (spot level)": [[40, "Human-Heart-(spot-level)"]], "Use Thor\u2019s API: run_commot for data preprocessing and run COMMOT": [[40, "Use-Thor's-API:-run_commot-for-data-preprocessing-and-run-COMMOT"], [40, "id1"]], "We can now check the directions of VEGF signals via a streamplot (spot level)": [[40, "We-can-now-check-the-directions-of-VEGF-signals-via-a-streamplot-(spot-level)"]], "With the original spot data, VEGF signals are observed crossing a vessel region": [[40, "With-the-original-spot-data,-VEGF-signals-are-observed-crossing-a-vessel-region"]], "Human Heart (cell level based on Thor)": [[40, "Human-Heart-(cell-level-based-on-Thor)"]], "We can now check the directions of VEGF signals via a streamplot (cell level)": [[40, "We-can-now-check-the-directions-of-VEGF-signals-via-a-streamplot-(cell-level)"]], "With Thor inferred data, VEGF signals are observed initialized from a vessel region, which makes more sense": [[40, "With-Thor-inferred-data,-VEGF-signals-are-observed-initialized-from-a-vessel-region,-which-makes-more-sense"]], "DEG along signaling pathways": [[40, "DEG-along-signaling-pathways"]], "Release Notes": [[41, "release-notes"]]}, "indexentries": {"run_sparkx_r() (thor.analy.sparkx method)": [[6, "thor.analy.SPARKX.RUN_SPARKX_R"]], "sparkx (class in thor.analy)": [[6, "thor.analy.SPARKX"]], "compute_pattern_mean() (thor.analy.sparkx static method)": [[6, "thor.analy.SPARKX.compute_pattern_mean"]], "hierarchy_clustering() (thor.analy.sparkx method)": [[6, "thor.analy.SPARKX.hierarchy_clustering"]], "kmeans_clustering() (thor.analy.sparkx method)": [[6, "thor.analy.SPARKX.kmeans_clustering"]], "load_gene_modules() (thor.analy.sparkx method)": [[6, "thor.analy.SPARKX.load_gene_modules"]], "load_result() (thor.analy.sparkx method)": [[6, "thor.analy.SPARKX.load_result"]], "adata_to_mtx_conversion() (in module thor.analy)": [[7, "thor.analy.adata_to_mtx_conversion"]], "analyze_gene_expression_gradient() (in module thor.analy)": [[8, "thor.analy.analyze_gene_expression_gradient"]], "compute_dge_between_regions() (in module thor.analy)": [[9, "thor.analy.compute_dge_between_regions"]], "get_pathway_score() (in module thor.analy)": [[10, "thor.analy.get_pathway_score"]], "get_tf_activity() (in module thor.analy)": [[11, "thor.analy.get_tf_activity"]], "prepare_and_run_copykat() (in module thor.analy)": [[12, "thor.analy.prepare_and_run_copykat"]], "read_polygon_roi() (in module thor.analy)": [[13, "thor.analy.read_polygon_ROI"]], "run_commot() (in module thor.analy)": [[14, "thor.analy.run_commot"]], "copy() (thor.finest method)": [[15, "thor.fineST.copy"]], "finest (class in thor)": [[15, "thor.fineST"]], "get_reduced_genes() (thor.finest method)": [[15, "thor.fineST.get_reduced_genes"]], "load() (thor.finest class method)": [[15, "thor.fineST.load"]], "load_genes() (thor.finest method)": [[15, "thor.fineST.load_genes"]], "load_params() (thor.finest method)": [[15, "thor.fineST.load_params"]], "load_result() (thor.finest method)": [[15, "thor.fineST.load_result"]], "load_vae_model() (thor.finest method)": [[15, "thor.fineST.load_vae_model"]], "predict_gene_expression() (thor.finest method)": [[15, "thor.fineST.predict_gene_expression"]], "prepare_input() (thor.finest method)": [[15, "thor.fineST.prepare_input"]], "prepare_recipe() (thor.finest method)": [[15, "thor.fineST.prepare_recipe"]], "sanity_check() (thor.finest method)": [[15, "thor.fineST.sanity_check"]], "save() (thor.finest method)": [[15, "thor.fineST.save"]], "set_cell_features_csv_path() (thor.finest method)": [[15, "thor.fineST.set_cell_features_csv_path"]], "set_cell_features_list() (thor.finest method)": [[15, "thor.fineST.set_cell_features_list"]], "set_genes_for_prediction() (thor.finest method)": [[15, "thor.fineST.set_genes_for_prediction"]], "set_params() (thor.finest method)": [[15, "thor.fineST.set_params"]], "vae_training() (thor.finest method)": [[15, "thor.fineST.vae_training"]], "visualize_cell_network() (thor.finest method)": [[15, "thor.fineST.visualize_cell_network"]], "write_adata() (thor.finest method)": [[15, "thor.fineST.write_adata"]], "write_params() (thor.finest method)": [[15, "thor.fineST.write_params"]], "annotate_roi() (in module thor.pl)": [[16, "thor.pl.annotate_ROI"]], "clusters() (in module thor.pl)": [[17, "thor.pl.clusters"]], "deg() (in module thor.pl)": [[18, "thor.pl.deg"]], "fringe() (in module thor.pl)": [[19, "thor.pl.fringe"]], "multi_molecules() (in module thor.pl)": [[20, "thor.pl.multi_molecules"]], "multiple() (in module thor.pl)": [[21, "thor.pl.multiple"]], "single() (in module thor.pl)": [[22, "thor.pl.single"]], "single_molecule() (in module thor.pl)": [[23, "thor.pl.single_molecule"]], "spot_over() (in module thor.pl)": [[24, "thor.pl.spot_over"]], "spatial (class in thor.pp)": [[25, "thor.pp.Spatial"]], "process_transcriptome() (thor.pp.spatial method)": [[25, "thor.pp.Spatial.process_transcriptome"]], "wholeslideimage (class in thor.pp)": [[26, "thor.pp.WholeSlideImage"]], "get_bbox() (thor.pp.wholeslideimage static method)": [[26, "thor.pp.WholeSlideImage.get_bbox"]], "load_external_cell_features() (thor.pp.wholeslideimage method)": [[26, "thor.pp.WholeSlideImage.load_external_cell_features"]], "nuclei_segmentation() (thor.pp.wholeslideimage method)": [[26, "thor.pp.WholeSlideImage.nuclei_segmentation"]], "process() (thor.pp.wholeslideimage method)": [[26, "thor.pp.WholeSlideImage.process"]], "split() (thor.pp.wholeslideimage method)": [[26, "thor.pp.WholeSlideImage.split"]], "load_cellpose() (in module thor.pp)": [[27, "thor.pp.load_cellpose"]], "load_cellprofiler() (in module thor.pp)": [[28, "thor.pp.load_cellprofiler"]], "load_mask_npz() (in module thor.pp)": [[29, "thor.pp.load_mask_npz"]], "load_nuclei() (in module thor.pp)": [[30, "thor.pp.load_nuclei"]], "nuclei_segmentation() (in module thor.pp)": [[31, "thor.pp.nuclei_segmentation"]], "preprocess_image() (in module thor.pp)": [[32, "thor.pp.preprocess_image"]]}})